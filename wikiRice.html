<!DOCTYPE html>
<html>
<body id="bod">

<iframe src="https://wikipedia.org/wiki/Special:Random" height = 1000 width = 1000>
    
    </iframe>

<p id="spank"></p>
<p id="wank"></p>

<script>
	//Create a new object to interact with the server
	var xhr = new XMLHttpRequest();

	//This extracts text, is a WIP... currently grabs the first-ish 1200 chars in plain text. Not sure how to grab later
	var url = "https://en.wikipedia.org/w/api.php?origin=*&action=query&format=json&prop=extracts&titles=Animal&formatversion=2&excharacters=1200&exlimit=50&explaintext=1"

	// Provide 3 arguments (GET/POST, The URL, Async True/False)
	xhr.open('GET', url, true);

	// Once request has loaded...
	xhr.onload = function() {
		// Parse the request into JSON
		var data = JSON.parse(this.response);

					// Log the data object
		console.log(data);

		// Log the page objects
		console.log(data.query.pages[0].extract)

		// Loop through the data object
		// Pulling out the titles of each page
		for (var i in data.query.pages) {
			console.log(data.query.pages[i].title);
		}

		var content = data.query.pages[0].extract;

		processContent(content);

	}
	// Send request to the server asynchronously
	xhr.send();


	function processContent(content){
		text = new String(content)
		let validSentenceEnds = []

		let spaced = text.split(" ")
		for (var i = 0; i < spaced.length; i++) {
			item = spaced[i]
			if (item.charAt(item.length-1) == "."){
				if (item.length > 3 || item.charAt(0) == item.charAt(0).toLowerCase() ){
					validSentenceEnds[validSentenceEnds.length] = i
					console.log(item)
				}
			}
		}

		getSentenceByIndex(spaced, validSentenceEnds, 3)


	}

	function getSentenceByIndex(spaced, ends, index){


		var start = 0
		if (index > 0){
			start = ends[index-1]+1
		} else {
			start = 0 
		}
		

		let passage = spaced[start]
		for (var i = start+1; i <= ends[index]; i++){
			passage = passage + " " + spaced[i]
		}
		document.getElementById("spank").innerHTML = passage;
		return passage
	}


</script>

<form id = "myForm">
<input type="text" id="guess" name = "hue"/>
</form>

<script id="formHandle">

 	document.getElementById( "myForm" ).addEventListener( "submit", function ( event ) {
    	event.preventDefault();
    	JavaScript:check();
  	} );

	function check(){
		var nameValue = document.getElementById("guess").value;
		document.getElementById("wank").innerHTML = nameValue;
		document.getElementById("guess").value = " ";
	}

</script>

</body>
</html>
